class Memo{constructor(t){this.el=document.querySelector(t.el),this.url=t.url,this.tags=t.tags||{},this.img=t.img?`<img src="${t.img}">`:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" fill="#333"><rect x="0" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0s" dur="0.6s" repeatCount="indefinite"></animate></rect><rect x="10" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0.2s" dur="0.6s" repeatCount="indefinite"></animate></rect><rect x="20" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0.4s" dur="0.6s" repeatCount="indefinite"></animate></rect></svg>',this.currentPage=0,this.init()}$(t){return this.el.querySelector(t)}T(t){const e=new Date(t),[i,n,a,r,s]=[e.getFullYear(),String(e.getMonth()+1).padStart(2,"0"),String(e.getDate()).padStart(2,"0"),String(e.getHours()).padStart(2,"0"),String(e.getMinutes()).padStart(2,"0")];return`${i}-${n}-${a} ${r}:${s}`}create(t){return document.createElement(t)}async init(){this.el.innerHTML='<div id="memo-cont"></div><div id="memo-more" style="text-align:center;padding:2em"></div>',this.$("#memo-more").innerHTML=this.img,this.FD()}async FD(){const t=await fetch(`${this.url}/memo/0/${this.currentPage}/10`);if(!t.ok)throw new Error("Network response was not ok");const e=await t.json();this.RD(e)}RD(t){const{data:e,max:i}=t,n=document.createDocumentFragment();for(const t of e){let{body:e,date:i,tag:a}=t;const r=this.create("div");r.className="m-item",a=this.tags[a]?this.tags[a]:"未分類";const s=`<div class="i-cont">${e}</div><div class="i-meta"><time datetime="${i}">${this.T(i)}</time></div>`;r.innerHTML=s,n.appendChild(r)}const a=this.$("#memo-more");if(this.currentPage+1<i){const t=this.create("div");t.textContent="ʕ•ᴥ•ʔ Click me to load more.",t.addEventListener("click",(()=>{a.innerHTML=this.img,this.loadMore()})),a.innerHTML="",a.appendChild(t)}else a.innerHTML="૮₍•́₃•̀₎ა Really not a drop left.";this.$("#memo-cont").appendChild(n)}loadMore(){this.currentPage+=1,this.FD()}}