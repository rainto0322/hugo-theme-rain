class Memo{constructor(t){this.el=document.querySelector(t.el),this.url=t.url,this.tags=t.tags||{},this.img=t.img?`<img src="${t.img}">`:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" fill="#333"><rect x="0" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0s" dur="0.6s" repeatCount="indefinite"></animate></rect><rect x="10" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0.2s" dur="0.6s" repeatCount="indefinite"></animate></rect><rect x="20" y="0" width="4" height="15"><animate attributeName="opacity" values="1;.2;1" begin="0.4s" dur="0.6s" repeatCount="indefinite"></animate></rect></svg>',this.lazy=t.lazy?t.lazy:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWRhc2hhcnJheT0iMTYiIHN0cm9rZS1kYXNob2Zmc2V0PSIxNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik0xMiAzYzQuOTcgMCA5IDQuMDMgOSA5Ij48YW5pbWF0ZSBmaWxsPSJmcmVlemUiIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1kYXNob2Zmc2V0IiBkdXI9IjAuMnMiIHZhbHVlcz0iMTY7MCIvPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgZHVyPSIxLjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgdHlwZT0icm90YXRlIiB2YWx1ZXM9IjAgMTIgMTI7MzYwIDEyIDEyIi8+PC9wYXRoPjwvc3ZnPg==",this.cpage=0,this.init()}$(t){return this.el.querySelector(t)}T(t){const e=new Date(t),[i,a,n,s,r]=[e.getFullYear(),String(e.getMonth()+1).padStart(2,"0"),String(e.getDate()).padStart(2,"0"),String(e.getHours()).padStart(2,"0"),String(e.getMinutes()).padStart(2,"0")];return`${i}-${a}-${n} ${s}:${r}`}create(t){return document.createElement(t)}async init(){this.el.innerHTML='<div id="memo-cont"></div><div id="memo-more" style="text-align:center;padding:2em"></div>',this.$("#memo-more").innerHTML=this.img,this.FD()}async FD(){const t=await fetch(`${this.url}/memo/0/${this.cpage}/10`);if(!t.ok)throw new Error("Network response was not ok");const e=await t.json();this.RD(e)}RD(t){const{data:e,max:i}=t,a=document.createDocumentFragment();for(const t of e){let{body:e,date:i,tag:n}=t;const s=this.create("div");s.className="m-item",n=this.tags[n]?this.tags[n]:"未分類";const r=`<div class="i-cont">${e}</div><div class="i-meta"><time datetime="${i}">${this.T(i)}</time></div>`;s.innerHTML=r;const c=s.querySelectorAll("img");for(const t of c)t.setAttribute("loading","lazy"),t.setAttribute("data_src",t.src),t.src=this.lazy,t.onload=()=>{t.src=t.getAttribute("data_src"),t.classList.add("loaded")};a.appendChild(s)}const n=this.$("#memo-more");if(this.cpage+1<i){const t=this.create("div");t.textContent="ʕ•ᴥ•ʔ Click me to load more.",t.addEventListener("click",(()=>{n.innerHTML=this.img,this.loadMore()})),n.innerHTML="",n.appendChild(t)}else n.innerHTML="૮₍•́₃•̀₎ა Really not a drop left.";this.$("#memo-cont").appendChild(a)}loadMore(){this.cpage+=1,this.FD()}}